#include <EEPROM.h>
#include <LittleFS.h>
#include <ESP8266WiFi.h>

#define EEPROM_SIZE 512
#define RESET_BUTTON_PIN D5  // Ganti ke pin tombol yang kamu pakai

void factoryReset() {
  Serial.println("Memulai factory reset...");

  // 1. Hapus EEPROM
  EEPROM.begin(EEPROM_SIZE);
  for (int i = 0; i < EEPROM_SIZE; i++) {
    EEPROM.write(i, 0xFF);  // Atau 0
  }
  EEPROM.commit();
  Serial.println("EEPROM dihapus.");

  // 2. Hapus WiFi
  WiFi.disconnect(true);  // Hapus setting WiFi
  delay(500);
  Serial.println("WiFi settings dihapus.");

  // 3. Format LittleFS
  LittleFS.begin();
  LittleFS.format();
  Serial.println("LittleFS diformat.");

  Serial.println("Factory reset selesai.");
}

void setup() {
  Serial.begin(115200);
  delay(1000);

  pinMode(RESET_BUTTON_PIN, INPUT_PULLUP);  // Tombol aktif LOW

  // Cek jika tombol ditekan saat boot (tahan tombol saat reset)
  if (digitalRead(RESET_BUTTON_PIN) == LOW) {
    factoryReset();
  } else {
    Serial.println("Tidak ada reset. Jalan normal.");
  }
}

void loop() {
  // Program biasa kamu di sini, jika tidak mereset
}

